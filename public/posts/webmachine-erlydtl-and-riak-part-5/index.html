
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Webmachine, ErlyDTL and Riak - Part 5 - OJ's rants</title>
  <meta name="author" content="OJ Reeves">

  <link rel="openid.server" href="http://www.myopenid.com/server" />
  <link rel="openid.delegate" href="http://thecolonial.myopenid.com/" />
  <link rel="openid2.local_id" href="http://thecolonial.myopenid.com" />
  <link rel="openid2.provider" href="http://www.myopenid.com/server" />
  <meta http-equiv="X-XRDS-Location" content="http://www.myopenid.com/xrds?username=thecolonial.myopenid.com" />


  
  <meta name="description" content="Newcomers to the series should first take a look at the previous four parts of the [series][] (Part 1, Part 2, Part 3, Part 4) first to make sure &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="http://feeds.feedburner.com/OjsRants" rel="alternate" title="OJ's rants RSS 2.0" type="application/rss+xml">
  <link rel="canonical" href="http://buffered.io/posts/webmachine-erlydtl-and-riak-part-5">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  <script src="/javascripts/modernizr-2.0.js" type="text/javascript"></script>
  <script src="/javascripts/ender.js" type="text/javascript"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>

  <script type="text/javascript">
    Modernizr.load([
      { load: '//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js' },
      { load: '/javascripts/jquery.lightbox.js', complete: function() {
        $("a[rel^='lightbox']").lightbox();
      } }
    ]);
  </script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8648787-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">OJ's rants</a></h1>
  
    <h2>It's not about you, it's about the software</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/OjsRants" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:buffered.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/posts/archives">Archives</a></li>
  <li><a href="/+">About</a></li>
  <li><a href="http://www.google.com/recaptcha/mailhide/d?k=01KtoERsnUusX9vVliTm27uQ==&c=Be1wE57A4P96e6U9_HLCvw==">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Webmachine, ErlyDTL and Riak - Part 5</h1>
    
    
      <p class="meta">
        








  



<time datetime="2012-05-01T21:30:00+10:00" pubdate data-updated="true">01 May 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="right" src="/uploads/2010/09/riak-logo.png" title="'Riak Logo'" >Newcomers to the series should first take a look at the previous four parts of the [series][] (<a href="/posts/webmachine-erlydtl-and-riak-part-1/" title="Wembachine, ErlyDTL and Riak - Part 1">Part 1</a>, <a href="/posts/webmachine-erlydtl-and-riak-part-2/" title="Wembachine, ErlyDTL and Riak - Part 2">Part 2</a>, <a href="/posts/webmachine-erlydtl-and-riak-part-3/" title="Wembachine, ErlyDTL and Riak - Part 3">Part 3</a>, <a href="/posts/webmachine-erlydtl-and-riak-part-2/" title="Wembachine, ErlyDTL and Riak - Part 4">Part 4</a>) first to make sure that you&#8217;re up to speed. Feel free to read on if you feel comfortable with the general concepts in use.</p>

<p>When we finished <a href="/posts/webmachine-erlydtl-and-riak-part-2/" title="Wembachine, ErlyDTL and Riak - Part 4">Part 4</a> we were able to authenticate users using <a href="http://twitter.com/" title="Twitter">Twitter</a> and <a href="http://oauth.net/" title="OAuth">OAuth</a>, which is great as we can delegate the responsibility of password management to an external entity.</p>

<p>Now that we know who people are, we want them to be able to do something meanigful with their accounts. That&#8217;s what this post is all about.</p>

<!--more-->


<h2>Agenda</h2>

<p>This post is going to cover the following topics:</p>

<ol>
<li><em><a href="http://www.basho.com/developers.html#Riak" title="Riak">Riak</a> Secondary Indexes</em> - We&#8217;ll be using these so that we can link code snippet submissions to the users who submitted them.</li>
<li><em>Form submission with <a href="http://www.basho.com/developers.html#Webmachine" title="Webmachine">Webmachine</a></em> - Users will be able to submit code snippet pairs to the system once they&#8217;re logged in.</li>
<li><em>Site-wide authentication checks</em> - We&#8217;ll be implementing authorisation checks in a way such that each protected resource will behave nicely and redirect users to the appropriate location.</li>
<li><em>Listing of submissions per-user</em> - Viewing the submissions for a given user will pull out a list from Riak using the secondary indexes.</li>
<li><em>Tidying up of templates</em> - Now that we&#8217;ve got some content to render, we&#8217;ll put together some nicer templates to make the site a little nicer to look at.</li>
</ol>


<p>This post is shorter than <a href="/posts/webmachine-erlydtl-and-riak-part-2/" title="Wembachine, ErlyDTL and Riak - Part 4">Part 4</a>, but still a decent size. So, again, get yourself a drink and settle into your chair. Off we go!</p>

<h2>But First &#8230;</h2>

<p>Prior to continuing you should make sure you have the latest version of <a href="http://www.basho.com/developers.html#Riak" title="Riak">Riak</a> installed. If you don&#8217;t, please go and do this now (read <a href="/posts/webmachine-erlydtl-and-riak-part-1/" title="Wembachine, ErlyDTL and Riak - Part 1">Part 1</a> to learn how to build Riak from scratch).</p>

<h2>Enabling Secondary Indexes</h2>

<p>As already mentioned we&#8217;re going to be storing data in Riak and using the [Secondary Index][] feature to make it easier to link data together and do certain types of queries over that data. Given this requirement the first thing we should do is enable secondary indexes on our cluster.</p>

<p>As per the [Riak wiki entry][Secondary Index] &#8230;</p>

<blockquote><p>As of version 1.0, Secondary Indexes are enabled by configuring Riak to use the
ELevelDB backend <code>riak_kv_eleveldb_backend</code>. Currently, the ELevelDB backend is the
only index-capable backend.</p></blockquote>

<p>So we need to go through our Riak development cluster configuration and make sure that our backend is set up correctly. We have to modify all the <code>app.config</code> files, so to do this easily we can run one simple command:</p>

<p>-> TODO: add the two wildcards to the path below</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>vim /path/to/riak/dev/-wildcardsgohere-/app.config
</span></code></pre></td></tr></table></div></figure>


<p>This will open [VIM][] with all of the <code>app.config</code> files open so that we can easily made the necessary modifications. In each of these files, find the <code>riak_kv</code> configuration section and change the backend like so:</p>

<figure class='code'><figcaption><span>apps/csd_core/rebar.config  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span><span class='line'><span class="c">%% Riak KV config</span>
</span><span class='line'><span class="p">{</span><span class="n">riak_kv</span><span class="p">,</span> <span class="p">[</span>
</span><span class='line'>          <span class="c">%% Storage_backend specifies the Erlang module defining the storage</span>
</span><span class='line'>          <span class="c">%% mechanism that will be used on this node.</span>
</span><span class='line'>          <span class="p">{</span><span class="n">storage_backend</span><span class="p">,</span> <span class="n">riak_kv_eleveldb_backend</span><span class="p">},</span>
</span><span class='line'>          <span class="p">...</span> <span class="n">snip</span> <span class="p">...</span> <span class="p">]}</span>
</span><span class='line'><span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Done. Don&#8217;t forget to make sure your dev cluster is running again before you continue.</p>

<h2>Code Snippet Submission</h2>

<p>In case you&#8217;ve forgotten, the application we&#8217;re building (Code Smackdown - CSD), is a hot-or-not for code snippets with a twist. Users can submit two snippets of code which perform the same function and other users can vote for the snippet which they prefer. So what we need to do is allow (authenticated) users to post this kind of information. To do this, we need to understand how to do form submission using <a href="http://www.basho.com/developers.html#Webmachine" title="Webmachine">Webmachine</a>.</p>

<p>Let&#8217;s start by creating a new resource which we&#8217;ll be using to handle the form submission. First, edit <code>app.config</code> and add a new dispatch rule like so:</p>

<figure class='code'><figcaption><span>apps/csd_web/priv/app.config  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="p">{</span><span class="n">csd_web</span><span class="p">,</span>
</span><span class='line'>  <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span><span class="n">web</span><span class="p">,</span>
</span><span class='line'>      <span class="p">[</span>
</span><span class='line'>        <span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span><span class='line'>        <span class="p">{</span><span class="n">dispatch</span><span class="p">,</span>
</span><span class='line'>          <span class="p">[</span>
</span><span class='line'>            <span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span><span class='line'>            <span class="p">{[</span><span class="s">&quot;snippet&quot;</span><span class="p">],</span> <span class="n">csd_web_snippet_submit_resource</span><span class="p">,</span> <span class="p">[]},</span>
</span><span class='line'>            <span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span><span class='line'>          <span class="p">]}</span>
</span><span class='line'>      <span class="p">]</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">...</span> <span class="n">snip</span> <span class="p">...</span>
</span><span class='line'>  <span class="p">]}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice how we&#8217;re using the same resource URI as the one used to GET snippets (as shown in <a href="/posts/webmachine-erlydtl-and-riak-part-3/" title="Wembachine, ErlyDTL and Riak - Part 3">Part 3</a>). This is to appear more RESTful. We&#8217;ll be POSTing to <code>/snippet</code> to submit a new snippet while GETting from <code>/snippet/_snippet-id_</code> to read those which already exist.</p>

<p>Now that the route is set up, we need to create the resource which will handle it. Here is the full listing which we&#8217;ll go through in detail:</p>

<figure class='code'><figcaption><span>apps/csd_web/src/csd_web_snippet_submit_resource.erl  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Note:</strong> The code for Part 5 (this post) can be found on <a href="https://github.com/OJ/csd/tree/Part5-???" title="Source code for Part 5">Github</a>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">OJ Reeves</span></span>

      








  



<time datetime="2012-05-01T21:30:00+10:00" pubdate data-updated="true">01 May 2012</time>
      

<span class="categories">
  
    <a class='category' href='/categories/erlang/'>Erlang</a>, <a class='category' href='/categories/erlydtl/'>ErlyDTL</a>, <a class='category' href='/categories/functional-programming/'>Functional Programming</a>, <a class='category' href='/categories/howto/'>HOWTO</a>, <a class='category' href='/categories/oauth/'>OAuth</a>, <a class='category' href='/categories/riak/'>Riak</a>, <a class='category' href='/categories/twitter/'>Twitter</a>, <a class='category' href='/categories/webmachine/'>Webmachine</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://buffered.io/posts/webmachine-erlydtl-and-riak-part-5/" data-via="TheColonial" data-counturl="http://buffered.io/posts/webmachine-erlydtl-and-riak-part-5/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/posts/webmachine-erlydtl-and-riak-part-4/" title="Previous Post: Webmachine, ErlyDTL and Riak - Part 4">&laquo; Webmachine, ErlyDTL and Riak - Part 4</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>OJ on the Web</h1>
  <ul id="about_me">
    <li class="post">
      <a href="http://buffered.io/+" title="About OJ">About me</a>
    </li>
    <li class="post">
      <a href="http://functional.io/" title="Functional IO">Functional IO</a>
    </li>
    <li class="post">
      <a href="http://twitter.com/TheColonial" title="OJ @ Twitter">Twitter</a>
    </li>
    <li class="post">
      <a href="http://github.com/OJ/" title="OJ @ Github">Github</a>
    </li>
    <li class="post">
      <a href="http://bitbucket.org/OJ/" title="OJ @ Bitbucket">Bitbucket</a>
    </li>
    <li class="post">
      <a href="http://stackoverflow.com/users/611/oj" title="OJ @ SO">StackOverflow</a>
    </li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/posts/webmachine-erlydtl-and-riak-part-5/">Webmachine, ErlyDTL and Riak - Part 5</a>
      </li>
    
      <li class="post">
        <a href="/posts/webmachine-erlydtl-and-riak-part-4/">Webmachine, ErlyDTL and Riak - Part 4</a>
      </li>
    
      <li class="post">
        <a href="/posts/redirects-with-webmachine/">Redirects with Webmachine</a>
      </li>
    
      <li class="post">
        <a href="/posts/my-tools-list-2012/">My Tools List - 2012</a>
      </li>
    
      <li class="post">
        <a href="/posts/an-expert-at-23/">An Expert at 23</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("TheColonial", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/TheColonial" class="twitter-follow-button" data-show-count="false">Follow @TheColonial</a>
  
</section>

<section>
  <h1>Series</h1>
  <ul id="series">
    <li class='series'><a href='/series/project-euler/'>Project Euler (11)</a></li>
<li class='series'><a href='/series/web-development-with-erlang/'>Web Development with Erlang (5)</a></li>

  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/categories/asm/'>ASM (3)</a></li>
<li class='category'><a href='/categories/asp-net/'>ASP.NET (3)</a></li>
<li class='category'><a href='/categories/agile/'>Agile (1)</a></li>
<li class='category'><a href='/categories/algorithms/'>Algorithms (6)</a></li>
<li class='category'><a href='/categories/apple/'>Apple (3)</a></li>
<li class='category'><a href='/categories/being-in-the-industry/'>Being in the Industry (28)</a></li>
<li class='category'><a href='/categories/blogging/'>Blogging (15)</a></li>
<li class='category'><a href='/categories/c-/'>C# (15)</a></li>
<li class='category'><a href='/categories/clr/'>CLR (3)</a></li>
<li class='category'><a href='/categories/challenges/'>Challenges (7)</a></li>
<li class='category'><a href='/categories/databases/'>Databases (6)</a></li>
<li class='category'><a href='/categories/digital-rights/'>Digital Rights (7)</a></li>
<li class='category'><a href='/categories/erlang/'>Erlang (8)</a></li>
<li class='category'><a href='/categories/erlydtl/'>ErlyDTL (2)</a></li>
<li class='category'><a href='/categories/f-/'>F# (4)</a></li>
<li class='category'><a href='/categories/fail/'>Fail (2)</a></li>
<li class='category'><a href='/categories/food/'>Food (1)</a></li>
<li class='category'><a href='/categories/freeware/'>Freeware (9)</a></li>
<li class='category'><a href='/categories/functional-programming/'>Functional Programming (28)</a></li>
<li class='category'><a href='/categories/funny/'>Funny (9)</a></li>
<li class='category'><a href='/categories/games/'>Games (5)</a></li>
<li class='category'><a href='/categories/google/'>Google (10)</a></li>
<li class='category'><a href='/categories/guest-posts/'>Guest posts (1)</a></li>
<li class='category'><a href='/categories/howto/'>HOWTO (18)</a></li>
<li class='category'><a href='/categories/hardware/'>Hardware (9)</a></li>
<li class='category'><a href='/categories/haskell/'>Haskell (20)</a></li>
<li class='category'><a href='/categories/linux/'>Linux (10)</a></li>
<li class='category'><a href='/categories/mac-os/'>Mac OS (2)</a></li>
<li class='category'><a href='/categories/merb/'>Merb (1)</a></li>
<li class='category'><a href='/categories/mercurial/'>Mercurial (3)</a></li>
<li class='category'><a href='/categories/microsoft/'>Microsoft (18)</a></li>
<li class='category'><a href='/categories/miscellaneous/'>Miscellaneous (56)</a></li>
<li class='category'><a href='/categories/mono/'>Mono (2)</a></li>
<li class='category'><a href='/categories/networks/'>Networks (2)</a></li>
<li class='category'><a href='/categories/nosql/'>NoSQL (3)</a></li>
<li class='category'><a href='/categories/oauth/'>OAuth (2)</a></li>
<li class='category'><a href='/categories/open-source/'>Open Source (2)</a></li>
<li class='category'><a href='/categories/privacy/'>Privacy (3)</a></li>
<li class='category'><a href='/categories/productivity/'>Productivity (1)</a></li>
<li class='category'><a href='/categories/project-euler/'>Project Euler (11)</a></li>
<li class='category'><a href='/categories/rce/'>RCE (4)</a></li>
<li class='category'><a href='/categories/riak/'>Riak (7)</a></li>
<li class='category'><a href='/categories/ruby-on-rails/'>Ruby on Rails (1)</a></li>
<li class='category'><a href='/categories/screencasts/'>Screencasts (1)</a></li>
<li class='category'><a href='/categories/security/'>Security (10)</a></li>
<li class='category'><a href='/categories/series/'>Series (1)</a></li>
<li class='category'><a href='/categories/shortcuts/'>Shortcuts (4)</a></li>
<li class='category'><a href='/categories/software/'>Software (31)</a></li>
<li class='category'><a href='/categories/software-development/'>Software Development (66)</a></li>
<li class='category'><a href='/categories/sorting/'>Sorting (5)</a></li>
<li class='category'><a href='/categories/technology/'>Technology (40)</a></li>
<li class='category'><a href='/categories/testing/'>Testing (1)</a></li>
<li class='category'><a href='/categories/tips-tricks/'>Tips/Tricks (11)</a></li>
<li class='category'><a href='/categories/twitter/'>Twitter (3)</a></li>
<li class='category'><a href='/categories/wpf/'>WPF (1)</a></li>
<li class='category'><a href='/categories/wtf/'>WTF (20)</a></li>
<li class='category'><a href='/categories/webmachine/'>Webmachine (7)</a></li>
<li class='category'><a href='/categories/windows/'>Windows (12)</a></li>

  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
Copyright &copy; 2012 -
<span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Blog content for OJ's rants</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://buffered.io/+" property="cc:attributionName" rel="cc:attributionURL">OJ Reeves</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ojsrants';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://buffered.io/posts/webmachine-erlydtl-and-riak-part-5/';
        var disqus_url = 'http://buffered.io/posts/webmachine-erlydtl-and-riak-part-5/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
